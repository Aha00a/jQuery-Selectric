/*! SelEctric ÏŸ v1.4.5 | Copyright (c) 2013 Leonardo Santos; Dual licensed: MIT/GPL */
(function(g,L){function l(c,b){this.element=c;this.options=g.extend(h,b);h.disableOnMobile&&!/android|ip(hone|od|ad)/i.test(navigator.userAgent)&&this.init(h)}var b="selectric",h={onOpen:function(){},onClose:function(){},maxHeight:300,keySearchTimeout:500,arrowButtonMarkup:'<span class="button">&#9662;</span>',disableOnMobile:!0,margin:5,border:1};l.prototype.init=function(c){function E(){u.empty();var a=e.find("option"),d="",c=a.length,b=a.filter(":"+q).index();j=0>b?0:b;c&&(a.each(function(a){var b=g(this),f=a==j?q:"",e=b.text(),b=b.val(),m=p,n=a,k=e,l,h="40-46 50-53 54-57 62-70 71-74 61 47 77".replace(/\d+/g,"\\3$&").split(" ");for(l in h)k=k.toLowerCase().replace(RegExp("["+h[l]+"]","g"),"aeiouncy".charAt(l));m[n]={value:b,text:e,slug:k};++a==c&&(f+=" last");v=a;d+='<li class="'+f+'" data-value="'+b+'">'+e+"</li>"}),u.append(d),z.text(p[j].text));m.unbind(n);e.unbind(F+" focusin");k.removeClass().addClass([G,e.prop("class"),H].join(" "));e.prop("disabled")||(k.removeClass(H),m.bind(I,function(a){r?w(a):A(a)}),e.bind(F,h).bind("focusin"+n,function(a){r||A(a)}),u=f.find("ul"),x=u.find("li").click(function(a){a.stopPropagation();s(g(this).index(),!0)}))}function h(a){a.preventDefault();var d=a.keyCode;/^3[78]$/.test(d)&&s((0<j?j:v)-1);/^39|40$/.test(d)&&s((j+1)%v);/^9|13|27$/.test(d)&&(a.stopPropagation(),s(j,!0))}function A(a){a.preventDefault();a.stopPropagation();g("."+B+" select")[b]("close");r=!0;l();var d=t.scrollTop();"click"==a.type&&e.focus();t.scrollTop(d);C.bind(I,w);k.addClass(B);J(j);c.onOpen.call(this)}function l(){if(r){var a=f.offset().top,d=f.height(),b=m.offset().top;f.show().css("top","");if(a+d>C.height()||k.offset().top+d>t.scrollTop()+t.height())f.css("top",-d),0>a-d&&b<c.maxHeight&&f.height(b-c.margin);D()}}function w(){var a=p[j].text;f.hide();e.blur();a!=z.text()&&e.change();z.text(a);k.removeClass(B);r=!1;C.unbind(n);c.onClose.call(e)}function s(a,d){e.val(p[j=a].value).find("option").eq(a).prop(q,!0);x.removeClass(q).eq(a).addClass(q);J(a);d&&w()}function J(a){var d=x.eq(a).outerHeight();a=x[a].offsetTop;var b=f.scrollTop(),c=f.height(),e=a+2*d;e>b+c?f.scrollTop(e-c):a-d<b&&f.scrollTop(a-d)}function D(){var a=f.closest(":visible").children(),d=b+"TempShow";a.addClass(d);f.height()>c.maxHeight&&f.height(c.maxHeight);f.width(m.outerWidth()-2*c.border);a.removeClass(d)}var m=g('<div class="'+b+'"><p class="label"/>'+c.arrowButtonMarkup+"</div>"),e=g(this.element),k=e.data(b,this).wrap("<div/>").parent().hover(function(){g(this).toggleClass("hover")}).append(m),p=[],r=!1,z=m.find(".label"),f=g('<div class="'+b+'Items"><ul/></div>').appendTo(k),u=f.find("ul"),x,n=".sl",C=g(document),t=g(L),F="keydown"+n,I="click"+n,y="",K,B=b+"Open",G=b+"Wrapper",H=b+"Disabled",q="selected",j=0,v;e.wrap('<div class="'+b+'HideSelect"/>');E();e.bind("keydown",function(a){var b=a.keyCode||a.which;a=0;clearTimeout(K);if(37>b||40<b){for(b=RegExp("^"+(y+=String.fromCharCode(b)),"i");++a<v;)if(b.test(p[a].slug)||b.test(p[a].text)){s(a);break}K=setTimeout(function(){y=""},c.keySearchTimeout)}else y=""});t.scroll(l);D();e.bind({refresh:function(){E();D()},destroy:function(){f.remove();m.remove();e.removeData(b).unbind(n+" refresh destroy open close").unwrap("."+b+"HideSelect").unwrap("."+G)},open:A,close:w})};g.fn[b]=function(c,h){return this.each(function(){g.data(this,b)?""+c===c&&g(this).trigger(c):new l(this,c?c:h)})}})(jQuery,window);